# loader åŒ¹é…è§„åˆ™
loader çš„åŒ¹é…è§„åˆ™ä¸­æœ‰ä¸¤ä¸ªæœ€å…³é”®çš„å› ç´ ï¼šä¸€ä¸ªæ˜¯åŒ¹é…æ¡ä»¶ï¼Œä¸€ä¸ªæ˜¯åŒ¹é…è§„åˆ™åçš„åº”ç”¨ã€‚


## åŒ¹é…æ¡ä»¶
```js
module.exports = {
  // ...
  module: {
    rules: [ 
      {
        test: /\.jsx?/, // æ¡ä»¶
        include: [ 
          path.resolve(__dirname, 'src'),
        ], // æ¡ä»¶
        use: 'babel-loader', // è§„åˆ™åº”ç”¨ç»“æœ
      }, // ä¸€ä¸ª object å³ä¸€æ¡è§„åˆ™
    
    ],
  },
}
```
å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªåŒ¹é…æ–‡ä»¶çš„åç¼€åå†³å®šç”¨ä»€ä¹ˆloader

1. { test: ... } åŒ¹é…ç‰¹å®šæ¡ä»¶
2. { include: ... } åŒ¹é…ç‰¹å®šè·¯å¾„
3. { exclude: ... } æ’é™¤ç‰¹å®šè·¯å¾„
4. { and: [...] }å¿…é¡»åŒ¹é…æ•°ç»„ä¸­æ‰€æœ‰æ¡ä»¶
5. { or: [...] } åŒ¹é…æ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªæ¡ä»¶
6. { not: [...] } æ’é™¤åŒ¹é…æ•°ç»„ä¸­æ‰€æœ‰æ¡ä»¶

ä¸Šè¿°çš„æ‰€è°“æ¡ä»¶çš„å€¼å¯ä»¥æ˜¯ï¼š

- å­—ç¬¦ä¸²ï¼šå¿…é¡»ä»¥æä¾›çš„å­—ç¬¦ä¸²å¼€å§‹ï¼Œæ‰€ä»¥æ˜¯å­—ç¬¦ä¸²çš„è¯ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æä¾›ç»å¯¹è·¯å¾„
- æ­£åˆ™è¡¨è¾¾å¼ï¼šè°ƒç”¨æ­£åˆ™çš„ test æ–¹æ³•æ¥åˆ¤æ–­åŒ¹é…
- å‡½æ•°ï¼š(path) => booleanï¼Œè¿”å› true è¡¨ç¤ºåŒ¹é…
- æ•°ç»„ï¼šè‡³å°‘åŒ…å«ä¸€ä¸ªæ¡ä»¶çš„æ•°ç»„
- å¯¹è±¡ï¼šåŒ¹é…æ‰€æœ‰å±æ€§å€¼çš„æ¡ä»¶...


```js
rules: [
  {
    test: /\.jsx?/, // æ­£åˆ™
    include: [
      path.resolve(__dirname, 'src'), // å­—ç¬¦ä¸²ï¼Œæ³¨æ„æ˜¯ç»å¯¹è·¯å¾„
    ], // æ•°ç»„
    // ...
  },
  {
    test: {
      js: /\.js/,
      jsx: /\.jsx/,
    }, // å¯¹è±¡ï¼Œä¸å»ºè®®ä½¿ç”¨
    not: [
      (value) => { /* ... */ return true; }, // å‡½æ•°ï¼Œé€šå¸¸éœ€è¦é«˜åº¦è‡ªå®šä¹‰æ—¶æ‰ä¼šä½¿ç”¨
    ],
  },
]
```

## åŒ¹é…åçš„é…ç½®
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ use å­—æ®µï¼š
```js
rules: [
  {
    test: /\.less/,
    use: [
      'style-loader', // ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²è¡¨ç¤º loader
      {
        loader: 'css-loader',
        options: {
          importLoaders: 1
        },
      }, // ç”¨å¯¹è±¡è¡¨ç¤º loaderï¼Œå¯ä»¥ä¼ é€’ loader é…ç½®ç­‰
      {
        loader: 'less-loader',
        options: {
          noIeCompat: true
        }, // ä¼ é€’ loader é…ç½®
      },
    ],
  },
],
```

use å­—æ®µå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…è¡¨ç¤º loader çš„å¯¹è±¡ã€‚å¦‚æœåªéœ€è¦ä¸€ä¸ª loaderï¼Œä¹Ÿå¯ä»¥è¿™æ ·ï¼šuse: { loader: 'babel-loader', options: { ... } }ã€‚


# loaderçš„åº”ç”¨é¡ºåº
å…ˆè¯´è§„åˆ™ï¼šåŒä¸€ä¸ªruleé‡Œé¢ä»åå‘å‰ï¼Œåœ¨rulesæ•°ç»„é‡Œé¢å¦‚æœåŒ¹é…åˆ°åŒä¸€ä¸ªï¼Œçœ‹enforce

## åœ¨ä¸€ä¸ªruleé‡Œé¢ï¼Œä»åå‘å‰
å‰é¢æåˆ°ï¼Œä¸€ä¸ªruleå¯ä»¥é…ç½®ä½¿ç”¨å¤šä¸ª loaderï¼Œæ‰§è¡Œé¡ºåºæ˜¯ä»æœ€åé…ç½®çš„ loader å¼€å§‹ï¼Œä¸€æ­¥æ­¥å¾€å‰ã€‚
ä¾‹å¦‚ï¼Œå¯¹äºä¸Šé¢çš„ less è§„åˆ™é…ç½®ï¼Œä¸€ä¸ª style.less æ–‡ä»¶ä¼šé€”å¾„ less-loaderã€css-loaderã€style-loader å¤„ç†ï¼Œæˆä¸ºä¸€ä¸ªå¯ä»¥æ‰“åŒ…çš„æ¨¡å—ã€‚

![](http://p8cyzbt5x.bkt.clouddn.com/UC20180615_005531.png)

## åœ¨rulesæ•°ç»„é‡Œé¢çœ‹enforce
æ¯ä¸€ä¸ªruleéƒ½æä¾›äº†enforceçš„å±æ€§ï¼Œé»˜è®¤æ˜¯æ™®é€šï¼Œè¿˜å¯ä»¥é…ç½®`pre`å’Œ`post`
æ‰§è¡Œé¡ºåºæ˜¯`pre` > `æ™®é€š` > `post`
```js
rules: [
  {
    test: /\.js$/,
    exclude: /node_modules/,
    loader: "eslint-loader",
    enforce: 'pre'
  },
  {
    test: /\.js$/,
    exclude: /node_modules/,
    loader: "babel-loader",
  },
]
```
ä¸Šé¢çš„`eslint`ä¼šå…ˆæ‰§è¡Œã€‚


# å°ç»“

loader åœ¨ module.rules æ•°ç»„é‡Œé¢é…ï¼Œ`rule`é‡Œé¢éœ€è¦æœ‰åŒ¹é…æ¡ä»¶ï¼š`test`,`exclude`,`include`,`not`, éœ€è¦æœ‰å¯¹loaderçš„é…ç½®ï¼š
 `use`é…ç½®loader
 æ³¨æ„loaderçš„é¡ºåºï¼Œåœ¨ruleå†…æ˜¯ä»åå‘å‰ï¼Œåœ¨rulesæ•°ç»„å†…æ˜¯çœ‹enforce


